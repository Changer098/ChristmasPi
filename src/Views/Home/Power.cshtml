@{
    ViewData["Title"] = "Power Settings";
    ViewData["ActivePage"] = "Power";
    @model ChristmasPi.Models.PowerModel;
    ViewBag.TreeName = Model.TreeName;
}
@section Scripts {
<script type="text/javascript">
    $(function () {
        $("#power-checkbox").bootstrapSwitch();
        $('#power-checkbox').on('switchChange.bootstrapSwitch', function (e, data) {
            if (data)
                TurnOn();
            else
                TurnOff();
        });
    });
    function TurnOn() {
        // /api/power/on
        var oReq = new XMLHttpRequest();
        oReq.addEventListener("load", function () {
            if (this.status !== 200) {
                showErrorModal("Failed to turn on");
            }
            else {
                location.reload();
            }
        });
        oReq.open("POST", "/api/power/on");
        oReq.send();
    }
    function TurnOff() {
        // /api/power/on
        var oReq = new XMLHttpRequest();
        oReq.addEventListener("load", function () {
            if (this.status !== 200) {
                showErrorModal("Failed to turn on");
            }
            else {
                location.reload();
            }
        });
        oReq.open("POST", "/api/power/off");
        oReq.send();
    }
</script>
}
<input type="checkbox" id="power-checkbox" @(Model.PoweredOff ? "" : "checked")>